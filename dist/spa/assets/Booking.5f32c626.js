import{c as Y,o as Ie,h as b,T as He,r as A,a as v,G as Ae,g as Z,i as Me,e as W,L as pe,M as Ne,p as Ve,N as Qe,w as Be,n as C,O as M,t as H,s as B,q as E,P as $,x as Ee,u as G,Q as oe,R as se,v as ie,S as $e,U as ue}from"./index.ba82616d.js";import{a as ze,R as Le,Q as ce}from"./QBtn.7fdb13ad.js";import{u as Oe,a as Ue,b as Ye,c as je,d as Fe,e as Ke,f as Re,Q as We,g as de,h as Ge,i as J,j as Je,k as Xe,r as Ze}from"./ro.f8847afa.js";import{h as X,b as et,c as tt}from"./render.9b25e6f3.js";import"./scroll.a3644e16.js";var at=Y({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:p,emit:S}){let f=!1,l,u,g=null,h=null,d,_;function y(){l&&l(),l=null,f=!1,g!==null&&(clearTimeout(g),g=null),h!==null&&(clearTimeout(h),h=null),u!==void 0&&u.removeEventListener("transitionend",d),d=null}function D(o,n,s){n!==void 0&&(o.style.height=`${n}px`),o.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,f=!0,l=s}function c(o,n){o.style.overflowY=null,o.style.height=null,o.style.transition=null,y(),n!==_&&S(n)}function P(o,n){let s=0;u=o,f===!0?(y(),s=o.offsetHeight===o.scrollHeight?0:void 0):(_="hide",o.style.overflowY="hidden"),D(o,s,n),g=setTimeout(()=>{g=null,o.style.height=`${o.scrollHeight}px`,d=w=>{h=null,(Object(w)!==w||w.target===o)&&c(o,"show")},o.addEventListener("transitionend",d),h=setTimeout(d,e.duration*1.1)},100)}function T(o,n){let s;u=o,f===!0?y():(_="show",o.style.overflowY="hidden",s=o.scrollHeight),D(o,s,n),g=setTimeout(()=>{g=null,o.style.height=0,d=w=>{h=null,(Object(w)!==w||w.target===o)&&c(o,"hide")},o.addEventListener("transitionend",d),h=setTimeout(d,e.duration*1.1)},100)}return Ie(()=>{f===!0&&y()}),()=>b(He,{css:!1,appear:e.appear,onEnter:P,onLeave:T},p.default)}}),fe=Y({name:"StepHeader",props:{stepper:{},step:{},goToPanel:Function},setup(e,{attrs:p}){const{proxy:{$q:S}}=Z(),f=A(null),l=v(()=>e.stepper.modelValue===e.step.name),u=v(()=>{const n=e.step.disable;return n===!0||n===""}),g=v(()=>{const n=e.step.error;return n===!0||n===""}),h=v(()=>{const n=e.step.done;return u.value===!1&&(n===!0||n==="")}),d=v(()=>{const n=e.step.headerNav,s=n===!0||n===""||n===void 0;return u.value===!1&&e.stepper.headerNav&&s}),_=v(()=>e.step.prefix&&(l.value===!1||e.stepper.activeIcon==="none")&&(g.value===!1||e.stepper.errorIcon==="none")&&(h.value===!1||e.stepper.doneIcon==="none")),y=v(()=>{const n=e.step.icon||e.stepper.inactiveIcon;if(l.value===!0){const s=e.step.activeIcon||e.stepper.activeIcon;return s==="none"?n:s||S.iconSet.stepper.active}if(g.value===!0){const s=e.step.errorIcon||e.stepper.errorIcon;return s==="none"?n:s||S.iconSet.stepper.error}if(u.value===!1&&h.value===!0){const s=e.step.doneIcon||e.stepper.doneIcon;return s==="none"?n:s||S.iconSet.stepper.done}return n}),D=v(()=>{const n=g.value===!0?e.step.errorColor||e.stepper.errorColor:void 0;if(l.value===!0){const s=e.step.activeColor||e.stepper.activeColor||e.step.color;return s!==void 0?s:n}return n!==void 0?n:u.value===!1&&h.value===!0?e.step.doneColor||e.stepper.doneColor||e.step.color||e.stepper.inactiveColor:e.step.color||e.stepper.inactiveColor}),c=v(()=>"q-stepper__tab col-grow flex items-center no-wrap relative-position"+(D.value!==void 0?` text-${D.value}`:"")+(g.value===!0?" q-stepper__tab--error q-stepper__tab--error-with-"+(_.value===!0?"prefix":"icon"):"")+(l.value===!0?" q-stepper__tab--active":"")+(h.value===!0?" q-stepper__tab--done":"")+(d.value===!0?" q-stepper__tab--navigation q-focusable q-hoverable":"")+(u.value===!0?" q-stepper__tab--disabled":"")),P=v(()=>e.stepper.headerNav!==!0?!1:d.value);function T(){f.value!==null&&f.value.focus(),l.value===!1&&e.goToPanel(e.step.name)}function o(n){n.keyCode===13&&l.value===!1&&e.goToPanel(e.step.name)}return()=>{const n={class:c.value};d.value===!0&&(n.onClick=T,n.onKeyup=o,Object.assign(n,u.value===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:p.tabindex||0}));const s=[b("div",{class:"q-focus-helper",tabindex:-1,ref:f}),b("div",{class:"q-stepper__dot row flex-center q-stepper__line relative-position"},[b("span",{class:"row flex-center"},[_.value===!0?e.step.prefix:b(ze,{name:y.value})])])];if(e.step.title!==void 0&&e.step.title!==null){const w=[b("div",{class:"q-stepper__title"},e.step.title)];e.step.caption!==void 0&&e.step.caption!==null&&w.push(b("div",{class:"q-stepper__caption"},e.step.caption)),s.push(b("div",{class:"q-stepper__label q-stepper__line relative-position"},w))}return Ae(b("div",n,s),[[Le,P.value]])}}});function me(e){return b("div",{class:"q-stepper__step-content"},[b("div",{class:"q-stepper__step-inner"},X(e.default))])}const ve={setup(e,{slots:p}){return()=>me(p)}};var U=Y({name:"QStep",props:{...Oe,icon:String,color:String,title:{type:String,required:!0},caption:String,prefix:[String,Number],doneIcon:String,doneColor:String,activeIcon:String,activeColor:String,errorIcon:String,errorColor:String,headerNav:{type:Boolean,default:!0},done:Boolean,error:Boolean,onScroll:[Function,Array]},setup(e,{slots:p,emit:S}){const{proxy:{$q:f}}=Z(),l=Me(pe,W);if(l===W)return console.error("QStep needs to be a child of QStepper"),W;const{getCache:u}=Ue(),g=A(null),h=v(()=>l.value.modelValue===e.name),d=v(()=>f.platform.is.ios!==!0&&f.platform.is.chrome===!0||h.value!==!0||l.value.vertical!==!0?{}:{onScroll(D){const{target:c}=D;c.scrollTop>0&&(c.scrollTop=0),e.onScroll!==void 0&&S("scroll",D)}}),_=v(()=>typeof e.name=="string"||typeof e.name=="number"?e.name:String(e.name));function y(){const D=l.value.vertical;return D===!0&&l.value.keepAlive===!0?b(Ne,l.value.keepAliveProps.value,h.value===!0?[b(l.value.needsUniqueKeepAliveWrapper.value===!0?u(_.value,()=>({...ve,name:_.value})):ve,{key:_.value},p.default)]:void 0):D!==!0||h.value===!0?me(p):void 0}return()=>b("div",{ref:g,class:"q-stepper__step",role:"tabpanel",...d.value},l.value.vertical===!0?[b(fe,{stepper:l.value,step:e,goToPanel:l.value.goToPanel}),l.value.animated===!0?b(at,y):y()]:[y()])}});const nt=/(-\w)/g;function lt(e){const p={};for(const S in e){const f=S.replace(nt,l=>l[1].toUpperCase());p[f]=e[S]}return p}var rt=Y({name:"QStepper",props:{...Ye,...je,flat:Boolean,bordered:Boolean,alternativeLabels:Boolean,headerNav:Boolean,contracted:Boolean,headerClass:String,inactiveColor:String,inactiveIcon:String,doneIcon:String,doneColor:String,activeIcon:String,activeColor:String,errorIcon:String,errorColor:String},emits:Fe,setup(e,{slots:p}){const S=Z(),f=Ke(e,S.proxy.$q),{updatePanelsList:l,isValidPanelName:u,updatePanelIndex:g,getPanelContent:h,getPanels:d,panelDirectives:_,goToPanel:y,keepAliveProps:D,needsUniqueKeepAliveWrapper:c}=Re();Ve(pe,v(()=>({goToPanel:y,keepAliveProps:D,needsUniqueKeepAliveWrapper:c,...e})));const P=v(()=>`q-stepper q-stepper--${e.vertical===!0?"vertical":"horizontal"}`+(e.flat===!0?" q-stepper--flat":"")+(e.bordered===!0?" q-stepper--bordered":"")+(f.value===!0?" q-stepper--dark q-dark":"")),T=v(()=>`q-stepper__header row items-stretch justify-between q-stepper__header--${e.alternativeLabels===!0?"alternative":"standard"}-labels`+(e.flat===!1||e.bordered===!0?" q-stepper__header--border":"")+(e.contracted===!0?" q-stepper__header--contracted":"")+(e.headerClass!==void 0?` ${e.headerClass}`:""));function o(){const n=X(p.message,[]);if(e.vertical===!0){u(e.modelValue)&&g();const s=b("div",{class:"q-stepper__content"},X(p.default));return n===void 0?[s]:n.concat(s)}return[b("div",{class:T.value},d().map(s=>{const w=lt(s.props);return b(fe,{key:w.name,stepper:e,step:w,goToPanel:y})})),n,tt("div",{class:"q-stepper__content q-panel-parent"},h(),"cont",e.swipeable,()=>_.value)]}return()=>(l(p),b("div",{class:P.value},et(p.navigation,o())))}});const ot={class:"booking-page"},st={key:2},it={style:{display:"flex","align-items":"center","justify-content":"space-between"}},ut={key:3},ct={key:1,style:{"font-style":"italic"}},ht={__name:"Booking",setup(e){const{state:p,commit:S}=Qe(),f=A(""),l=A(""),u=A(""),g=A([]),h=Ze,d=A(0),_=[{label:"Manichiura clasica (30 minute)",value:"manichiura_clasica",duration:30},{label:"Pedichiura clasica (30 minute)",value:"pedichiura_clasica",duration:30},{label:"Pedichiura semipermanenta (60 minute)",value:"semi_permanenta_pedichiura",duration:60},{label:"Manichiura semipermanenta (60 minute)",value:"semi_permanenta_manichiura",duration:60},{label:"Intretinere gel (120 minute)",value:"intretinere_gel",duration:120}],y=v(()=>p.data.defaultSchedule),D=v(()=>p.data.listProviders),c=A(""),P=v(()=>p.data.appointments),T=v(()=>p.data.user),o=v(()=>{var a;return c?p.data.exeptionWeekendDays[(a=c.value)==null?void 0:a.value]:[]}),n=v(()=>p.data.disableDates),s=v(()=>p.data.scheduleModified),w=v(()=>_.map(a=>({label:a.label,value:a.value,duration:a.duration}))),j=v(()=>{var a,t;return((a=c.value)==null?void 0:a.value)&&u.value?P.value[(t=c.value)==null?void 0:t.value][u.value]||[]:[]}),ee=a=>{var i;const t=F(a);return n.value[(i=c.value)==null?void 0:i.value].includes(t)},te=a=>{const i=new Date(a).getDay();return i===0||i===6},ge=a=>{var x,k,I,q;const t=new Date;t.setHours(0,0,0,0);const i=new Date(a);if(ee(i)||i<t||te(i)&&!o.value.includes(F(i)))return!1;let r=(k=y.value[(x=c.value)==null?void 0:x.value])==null?void 0:k.end;const m=(q=s.value[(I=c.value)==null?void 0:I.value])==null?void 0:q[i.value];if(m&&(r=m.endHour),i.getTime()===t.getTime()){const z=new Date,[L,O]=r.split(":").map(Number),Q=new Date;return Q.setHours(L,O,0,0),z<Q}return!0},he=a=>{const t=new Date;t.setHours(0,0,0,0);const i=new Date;i.setDate(t.getDate()+1),i.setHours(0,0,0,0);const r=new Date;r.setDate(t.getDate()+2),r.setHours(0,0,0,0);const m=new Date(a);return ee(m)||m>=t&&m<r||te(m)&&!o.value.includes(F(m))?!1:m>=t},F=a=>J.formatDate(a,"YYYY-MM-DD"),be=(a,t)=>t==="owner"||t==="admin"?ge(a):he(a),ye=a=>be(a,T.value.role),Se=a=>{f.value=a,d.value=5},N=()=>{var a;if(f.value="",l.value&&u.value&&c.value){d.value=4;const i=_.find(m=>{var x;return m.value===((x=l.value)==null?void 0:x.value)}).duration,r=P.value[(a=c.value)==null?void 0:a.value][u.value];g.value=_e(i,r)}},_e=(a,t)=>{var L,O,Q,ae,ne,le;let i=(O=y.value[(L=c.value)==null?void 0:L.value])==null?void 0:O.start,r=(ae=y.value[(Q=c.value)==null?void 0:Q.value])==null?void 0:ae.end;const m=(le=s.value[(ne=c.value)==null?void 0:ne.value])==null?void 0:le[u.value];m&&(i=m.startHour,r=m.endHour);const x=[],k=new Date,I=u.value===k.toISOString().slice(0,10);let q=V(i);if(I){if(k.getHours()>=V(r).getHours())return[];q=new Date,q.setMinutes(Math.ceil(k.getMinutes()/30)*30,0,0)}const z=V(r);for(;q<z;){const K=new Date(q),R=new Date(q);if(R.setMinutes(K.getMinutes()+a),R>z)break;(t==null?void 0:t.some(re=>{const Pe=V(re.start),Te=V(re.end);return K<Te&&R>Pe}))||!1||x.push(De(K)),q.setMinutes(q.getMinutes()+30)}return x},V=a=>{const[t,i]=a.split(":").map(Number),r=new Date;return r.setHours(t,i,0,0),r},De=a=>a.toTimeString().slice(0,5);function we(a){d.value=3,c.value=a,u.value="",N()}function xe(a){l.value=a,d.value=2,N()}function ke(a=6){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let i="";for(let r=0;r<a;r++){const m=Math.floor(Math.random()*t.length);i+=t[m]}return i}function Ce(){var m,x,k,I;const a=`${u.value}T${f.value}:00`,t=J.addToDate(a,{minutes:l.value.duration}),i=J.formatDate(t,"HH:mm"),r={id:ke(),start:f.value,end:i,date:u.value,appointmentDetails:{label:(m=l.value)==null?void 0:m.label,value:(x=l.value)==null?void 0:x.value,duration:(k=l.value)==null?void 0:k.duration}};S("ADD_APPOINTMENT",{selectedProvider:(I=c.value)==null?void 0:I.value,selectedDate:u.value,appointment:r}),f.value="",N()}function qe(a){var t;S("DELETE_APPOINTMENT",{id:a,provider:(t=c.value)==null?void 0:t.value,date:u.value})}return Be(()=>P.value,a=>{N()},{deep:!0}),(a,t)=>(C(),M("div",ot,[H(rt,{style:{"max-width":"80%",margin:"0 auto"},modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=i=>d.value=i),ref:"stepper",animated:"",flat:"","done-color":"green","inactive-color":"grey"},{navigation:B(()=>t[6]||(t[6]=[])),default:B(()=>[H(U,{name:1,prefix:"1",title:"Selecteaza serviciu",done:d.value>1},null,8,["done"]),H(U,{name:2,prefix:"2",title:"Selecteaza tehnician",done:d.value>2},null,8,["done"]),H(U,{name:3,title:"Selecteaza data",prefix:"3",done:d.value>3},null,8,["done"]),H(U,{name:4,title:"Selecteaza ora",prefix:"4",done:d.value>4},null,8,["done"])]),_:1},8,["modelValue"]),H(We,{style:{"max-width":"500px",margin:"0 auto",display:"flex","flex-direction":"column",gap:"30px"}},{default:B(()=>{var i;return[H(de,{modelValue:l.value,"onUpdate:modelValue":[t[1]||(t[1]=r=>l.value=r),t[2]||(t[2]=r=>xe(r))],options:w.value,label:"Selecteaza serviciu","option-value":"value","option-label":"label"},null,8,["modelValue","options"]),l.value?(C(),E(de,{key:0,modelValue:c.value,"onUpdate:modelValue":[t[3]||(t[3]=r=>c.value=r),t[4]||(t[4]=r=>we(r))],options:D.value,label:"Selecteaza tehnician","option-value":"value","option-label":"label"},null,8,["modelValue","options"])):$("",!0),(i=c.value)!=null&&i.value?(C(),E(Ge,{key:1,class:"full-width",modelValue:u.value,"onUpdate:modelValue":[t[5]||(t[5]=r=>u.value=r),N],label:"Select Date",landscape:"",hint:"Choose the date for your appointment",mask:"YYYY-MM-DD",locale:Ee(h).date,options:ye},null,8,["modelValue","locale"])):$("",!0),j.value.length&&(T.value.role==="owner"||T.value.role==="admin")?(C(),M("div",st,[t[7]||(t[7]=G("h6",{style:{margin:"0"}},"Programari existente",-1)),(C(!0),M(oe,null,se(j.value,({start:r,end:m,appointmentDetails:x,id:k},I)=>(C(),M("div",{key:k,style:{display:"flex","flex-direction":"column"}},[G("div",it,[G("span",{style:$e(x.value==="off"&&"font-style: italic;color: #a2a2a2")},ue(`${r}-${m} - ${x.label}`),5),H(ce,{rounded:"",flat:"",color:"grey",dense:"",size:"12px",icon:"delete",onClick:q=>qe(k)},null,8,["onClick"])]),I+1!==j.value.length?(C(),E(Je,{key:0,style:{margin:"5px 0"}})):$("",!0)]))),128))])):$("",!0),u.value?(C(),M("div",ut,[(C(!0),M(oe,null,se(g.value,r=>(C(),E(Xe,{key:r,outline:f.value!==r,"onUpdate:selected":()=>Se(r),clickable:"",color:"primary","text-color":"white"},{default:B(()=>[ie(ue(r),1)]),_:2},1032,["outline","onUpdate:selected"]))),128)),g.value.length?(C(),E(ce,{key:0,disable:!f.value,class:"full-width",style:{"margin-top":"15px"},"no-caps":"",dense:"",color:"green",rounded:"",onClick:Ce},{default:B(()=>t[8]||(t[8]=[ie("Salveaza programarea ")])),_:1},8,["disable"])):(C(),M("span",ct,"Nu exista ora disponibila pentru data selectata !"))])):$("",!0)]}),_:1})]))}};export{ht as default};
