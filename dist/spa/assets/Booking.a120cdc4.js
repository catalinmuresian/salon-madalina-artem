import{c as z,o as xe,h,T as ke,r as I,a as p,G as Ce,g as W,i as qe,e as Y,L as ie,M as Pe,p as Te,N as He,w as Ie,n as x,O as A,t as H,s as Q,q as B,P as E,x as Ae,u as j,Q as te,R as ae,v as ne,S as Ve,U as le}from"./index.79b8746a.js";import{a as Ne,R as Me,Q as re}from"./QBtn.f9316213.js";import{u as Qe,a as Be,b as Ee,c as $e,d as ze,e as Le,f as Oe,Q as Ue,g as oe,h as Ye,i as F,j as je,k as Fe,r as Ke}from"./ro.c1db0c04.js";import{h as K,b as We,c as Re}from"./render.30861558.js";import"./scroll.09bfa5cb.js";var Ge=z({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:f,emit:S}){let v=!1,l,i,m=null,g=null,d,_;function D(){l&&l(),l=null,v=!1,m!==null&&(clearTimeout(m),m=null),g!==null&&(clearTimeout(g),g=null),i!==void 0&&i.removeEventListener("transitionend",d),d=null}function u(o,n,s){n!==void 0&&(o.style.height=`${n}px`),o.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,v=!0,l=s}function w(o,n){o.style.overflowY=null,o.style.height=null,o.style.transition=null,D(),n!==_&&S(n)}function C(o,n){let s=0;i=o,v===!0?(D(),s=o.offsetHeight===o.scrollHeight?0:void 0):(_="hide",o.style.overflowY="hidden"),u(o,s,n),m=setTimeout(()=>{m=null,o.style.height=`${o.scrollHeight}px`,d=y=>{g=null,(Object(y)!==y||y.target===o)&&w(o,"show")},o.addEventListener("transitionend",d),g=setTimeout(d,e.duration*1.1)},100)}function P(o,n){let s;i=o,v===!0?D():(_="show",o.style.overflowY="hidden",s=o.scrollHeight),u(o,s,n),m=setTimeout(()=>{m=null,o.style.height=0,d=y=>{g=null,(Object(y)!==y||y.target===o)&&w(o,"hide")},o.addEventListener("transitionend",d),g=setTimeout(d,e.duration*1.1)},100)}return xe(()=>{v===!0&&D()}),()=>h(ke,{css:!1,appear:e.appear,onEnter:C,onLeave:P},f.default)}}),ue=z({name:"StepHeader",props:{stepper:{},step:{},goToPanel:Function},setup(e,{attrs:f}){const{proxy:{$q:S}}=W(),v=I(null),l=p(()=>e.stepper.modelValue===e.step.name),i=p(()=>{const n=e.step.disable;return n===!0||n===""}),m=p(()=>{const n=e.step.error;return n===!0||n===""}),g=p(()=>{const n=e.step.done;return i.value===!1&&(n===!0||n==="")}),d=p(()=>{const n=e.step.headerNav,s=n===!0||n===""||n===void 0;return i.value===!1&&e.stepper.headerNav&&s}),_=p(()=>e.step.prefix&&(l.value===!1||e.stepper.activeIcon==="none")&&(m.value===!1||e.stepper.errorIcon==="none")&&(g.value===!1||e.stepper.doneIcon==="none")),D=p(()=>{const n=e.step.icon||e.stepper.inactiveIcon;if(l.value===!0){const s=e.step.activeIcon||e.stepper.activeIcon;return s==="none"?n:s||S.iconSet.stepper.active}if(m.value===!0){const s=e.step.errorIcon||e.stepper.errorIcon;return s==="none"?n:s||S.iconSet.stepper.error}if(i.value===!1&&g.value===!0){const s=e.step.doneIcon||e.stepper.doneIcon;return s==="none"?n:s||S.iconSet.stepper.done}return n}),u=p(()=>{const n=m.value===!0?e.step.errorColor||e.stepper.errorColor:void 0;if(l.value===!0){const s=e.step.activeColor||e.stepper.activeColor||e.step.color;return s!==void 0?s:n}return n!==void 0?n:i.value===!1&&g.value===!0?e.step.doneColor||e.stepper.doneColor||e.step.color||e.stepper.inactiveColor:e.step.color||e.stepper.inactiveColor}),w=p(()=>"q-stepper__tab col-grow flex items-center no-wrap relative-position"+(u.value!==void 0?` text-${u.value}`:"")+(m.value===!0?" q-stepper__tab--error q-stepper__tab--error-with-"+(_.value===!0?"prefix":"icon"):"")+(l.value===!0?" q-stepper__tab--active":"")+(g.value===!0?" q-stepper__tab--done":"")+(d.value===!0?" q-stepper__tab--navigation q-focusable q-hoverable":"")+(i.value===!0?" q-stepper__tab--disabled":"")),C=p(()=>e.stepper.headerNav!==!0?!1:d.value);function P(){v.value!==null&&v.value.focus(),l.value===!1&&e.goToPanel(e.step.name)}function o(n){n.keyCode===13&&l.value===!1&&e.goToPanel(e.step.name)}return()=>{const n={class:w.value};d.value===!0&&(n.onClick=P,n.onKeyup=o,Object.assign(n,i.value===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:f.tabindex||0}));const s=[h("div",{class:"q-focus-helper",tabindex:-1,ref:v}),h("div",{class:"q-stepper__dot row flex-center q-stepper__line relative-position"},[h("span",{class:"row flex-center"},[_.value===!0?e.step.prefix:h(Ne,{name:D.value})])])];if(e.step.title!==void 0&&e.step.title!==null){const y=[h("div",{class:"q-stepper__title"},e.step.title)];e.step.caption!==void 0&&e.step.caption!==null&&y.push(h("div",{class:"q-stepper__caption"},e.step.caption)),s.push(h("div",{class:"q-stepper__label q-stepper__line relative-position"},y))}return Ce(h("div",n,s),[[Me,C.value]])}}});function ce(e){return h("div",{class:"q-stepper__step-content"},[h("div",{class:"q-stepper__step-inner"},K(e.default))])}const se={setup(e,{slots:f}){return()=>ce(f)}};var $=z({name:"QStep",props:{...Qe,icon:String,color:String,title:{type:String,required:!0},caption:String,prefix:[String,Number],doneIcon:String,doneColor:String,activeIcon:String,activeColor:String,errorIcon:String,errorColor:String,headerNav:{type:Boolean,default:!0},done:Boolean,error:Boolean,onScroll:[Function,Array]},setup(e,{slots:f,emit:S}){const{proxy:{$q:v}}=W(),l=qe(ie,Y);if(l===Y)return console.error("QStep needs to be a child of QStepper"),Y;const{getCache:i}=Be(),m=I(null),g=p(()=>l.value.modelValue===e.name),d=p(()=>v.platform.is.ios!==!0&&v.platform.is.chrome===!0||g.value!==!0||l.value.vertical!==!0?{}:{onScroll(u){const{target:w}=u;w.scrollTop>0&&(w.scrollTop=0),e.onScroll!==void 0&&S("scroll",u)}}),_=p(()=>typeof e.name=="string"||typeof e.name=="number"?e.name:String(e.name));function D(){const u=l.value.vertical;return u===!0&&l.value.keepAlive===!0?h(Pe,l.value.keepAliveProps.value,g.value===!0?[h(l.value.needsUniqueKeepAliveWrapper.value===!0?i(_.value,()=>({...se,name:_.value})):se,{key:_.value},f.default)]:void 0):u!==!0||g.value===!0?ce(f):void 0}return()=>h("div",{ref:m,class:"q-stepper__step",role:"tabpanel",...d.value},l.value.vertical===!0?[h(ue,{stepper:l.value,step:e,goToPanel:l.value.goToPanel}),l.value.animated===!0?h(Ge,D):D()]:[D()])}});const Je=/(-\w)/g;function Xe(e){const f={};for(const S in e){const v=S.replace(Je,l=>l[1].toUpperCase());f[v]=e[S]}return f}var Ze=z({name:"QStepper",props:{...Ee,...$e,flat:Boolean,bordered:Boolean,alternativeLabels:Boolean,headerNav:Boolean,contracted:Boolean,headerClass:String,inactiveColor:String,inactiveIcon:String,doneIcon:String,doneColor:String,activeIcon:String,activeColor:String,errorIcon:String,errorColor:String},emits:ze,setup(e,{slots:f}){const S=W(),v=Le(e,S.proxy.$q),{updatePanelsList:l,isValidPanelName:i,updatePanelIndex:m,getPanelContent:g,getPanels:d,panelDirectives:_,goToPanel:D,keepAliveProps:u,needsUniqueKeepAliveWrapper:w}=Oe();Te(ie,p(()=>({goToPanel:D,keepAliveProps:u,needsUniqueKeepAliveWrapper:w,...e})));const C=p(()=>`q-stepper q-stepper--${e.vertical===!0?"vertical":"horizontal"}`+(e.flat===!0?" q-stepper--flat":"")+(e.bordered===!0?" q-stepper--bordered":"")+(v.value===!0?" q-stepper--dark q-dark":"")),P=p(()=>`q-stepper__header row items-stretch justify-between q-stepper__header--${e.alternativeLabels===!0?"alternative":"standard"}-labels`+(e.flat===!1||e.bordered===!0?" q-stepper__header--border":"")+(e.contracted===!0?" q-stepper__header--contracted":"")+(e.headerClass!==void 0?` ${e.headerClass}`:""));function o(){const n=K(f.message,[]);if(e.vertical===!0){i(e.modelValue)&&m();const s=h("div",{class:"q-stepper__content"},K(f.default));return n===void 0?[s]:n.concat(s)}return[h("div",{class:P.value},d().map(s=>{const y=Xe(s.props);return h(ue,{key:y.name,stepper:e,step:y,goToPanel:D})})),n,Re("div",{class:"q-stepper__content q-panel-parent"},g(),"cont",e.swipeable,()=>_.value)]}return()=>(l(f),h("div",{class:C.value},We(f.navigation,o())))}});const et={class:"booking-page"},tt={key:2},at={style:{display:"flex","align-items":"center","justify-content":"space-between"}},nt={key:3},lt={key:1,style:{"font-style":"italic"}},dt={__name:"Booking",setup(e){const{state:f,commit:S}=He(),v=I(""),l=I(""),i=I(""),m=I([]),g=Ke,d=I(0),_=[{label:"Manichiura clasica (30 minute)",value:"manichiura_clasica",duration:30},{label:"Pedichiura clasica (30 minute)",value:"pedichiura_clasica",duration:30},{label:"Pedichiura semipermanenta (60 minute)",value:"semi_permanenta_pedichiura",duration:60},{label:"Manichiura semipermanenta (60 minute)",value:"semi_permanenta_manichiura",duration:60},{label:"Intretinere gel (120 minute)",value:"intretinere_gel",duration:120}],D=p(()=>f.data.listProviders),u=I(""),w=p(()=>f.data.appointments),C=p(()=>f.data.user),P=p(()=>{var a;return u?f.data.exeptionWeekendDays[(a=u.value)==null?void 0:a.value]:[]}),o=p(()=>f.data.disableDates),n=p(()=>f.data.scheduleModified),s=p(()=>_.map(a=>({label:a.label,value:a.value,duration:a.duration}))),y=p(()=>{var a,t;return((a=u.value)==null?void 0:a.value)&&i.value?w.value[(t=u.value)==null?void 0:t.value][i.value]||[]:[]}),R=a=>{var c;const t=L(a);return o.value[(c=u.value)==null?void 0:c.value].includes(t)},G=a=>{const c=new Date(a).getDay();return c===0||c===6},de=a=>{const t=new Date;t.setHours(0,0,0,0);const c=new Date(a);if(R(c)||c<t||G(c)&&!P.value.includes(L(c)))return!1;if(c.getTime()===t.getTime()){const r=new Date,b=new Date;return b.setHours(17,0,0,0),r<b}return!0},ve=a=>{const t=new Date;t.setHours(0,0,0,0);const c=new Date;c.setDate(t.getDate()+1),c.setHours(0,0,0,0);const r=new Date;r.setDate(t.getDate()+2),r.setHours(0,0,0,0);const b=new Date(a);return R(b)||b>=t&&b<r||G(b)&&!P.value.includes(L(b))?!1:b>=t},L=a=>F.formatDate(a,"YYYY-MM-DD"),pe=(a,t)=>t==="owner"||t==="admin"?de(a):ve(a),fe=a=>pe(a,C.value.role),me=a=>{v.value=a,d.value=5},N=()=>{var a;if(v.value="",l.value&&i.value&&u.value){d.value=4;const c=_.find(b=>{var k;return b.value===((k=l.value)==null?void 0:k.value)}).duration,r=w.value[(a=u.value)==null?void 0:a.value][i.value];m.value=ge(c,r)}},ge=(a,t)=>{var X,Z;let c="10:00",r="17:00";const b=(Z=n.value[(X=u.value)==null?void 0:X.value])==null?void 0:Z[i.value];b&&(c=b.startHour,r=b.endHour);const k=[],q=new Date,V=i.value===q.toISOString().slice(0,10);let T=M(c);if(V){if(q.getHours()>=M(r).getHours())return[];T=new Date,T.setMinutes(Math.ceil(q.getMinutes()/30)*30,0,0)}const J=M(r);for(;T<J;){const O=new Date(T),U=new Date(T);if(U.setMinutes(O.getMinutes()+a),U>J)break;(t==null?void 0:t.some(ee=>{const De=M(ee.start),we=M(ee.end);return O<we&&U>De}))||!1||k.push(be(O)),T.setMinutes(T.getMinutes()+30)}return k},M=a=>{const[t,c]=a.split(":").map(Number),r=new Date;return r.setHours(t,c,0,0),r},be=a=>a.toTimeString().slice(0,5);function he(a){d.value=3,u.value=a,i.value="",N()}function ye(a){l.value=a,d.value=2,N()}function Se(){var b,k,q,V;const a=`${i.value}T${v.value}:00`,t=F.addToDate(a,{minutes:l.value.duration}),c=F.formatDate(t,"HH:mm"),r={start:v.value,end:c,date:i.value,appointmentDetails:{label:(b=l.value)==null?void 0:b.label,value:(k=l.value)==null?void 0:k.value,duration:(q=l.value)==null?void 0:q.duration}};S("ADD_APPOINTMENT",{selectedProvider:(V=u.value)==null?void 0:V.value,selectedDate:i.value,appointment:r}),v.value="",N()}function _e(a){var t;S("DELETE_APPOINTMENT",{id:a,provider:(t=u.value)==null?void 0:t.value,date:i.value})}return Ie(()=>w.value,a=>{N()},{deep:!0}),(a,t)=>(x(),A("div",et,[H(Ze,{style:{"max-width":"80%",margin:"0 auto"},modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=c=>d.value=c),ref:"stepper",animated:"",flat:"","done-color":"green","inactive-color":"grey"},{navigation:Q(()=>t[6]||(t[6]=[])),default:Q(()=>[H($,{name:1,prefix:"1",title:"Selecteaza serviciu",done:d.value>1},null,8,["done"]),H($,{name:2,prefix:"2",title:"Selecteaza tehnician",done:d.value>2},null,8,["done"]),H($,{name:3,title:"Selecteaza data",prefix:"3",done:d.value>3},null,8,["done"]),H($,{name:4,title:"Selecteaza ora",prefix:"4",done:d.value>4},null,8,["done"])]),_:1},8,["modelValue"]),H(Ue,{style:{"max-width":"500px",margin:"0 auto",display:"flex","flex-direction":"column",gap:"30px"}},{default:Q(()=>{var c;return[H(oe,{modelValue:l.value,"onUpdate:modelValue":[t[1]||(t[1]=r=>l.value=r),t[2]||(t[2]=r=>ye(r))],options:s.value,label:"Selecteaza serviciu","option-value":"value","option-label":"label"},null,8,["modelValue","options"]),l.value?(x(),B(oe,{key:0,modelValue:u.value,"onUpdate:modelValue":[t[3]||(t[3]=r=>u.value=r),t[4]||(t[4]=r=>he(r))],options:D.value,label:"Selecteaza tehnician","option-value":"value","option-label":"label"},null,8,["modelValue","options"])):E("",!0),(c=u.value)!=null&&c.value?(x(),B(Ye,{key:1,class:"full-width",modelValue:i.value,"onUpdate:modelValue":[t[5]||(t[5]=r=>i.value=r),N],label:"Select Date",landscape:"",hint:"Choose the date for your appointment",mask:"YYYY-MM-DD",locale:Ae(g).date,options:fe},null,8,["modelValue","locale"])):E("",!0),y.value.length&&(C.value.role==="owner"||C.value.role==="admin")?(x(),A("div",tt,[t[7]||(t[7]=j("h6",{style:{margin:"0"}},"Programari existente",-1)),(x(!0),A(te,null,ae(y.value,({start:r,end:b,appointmentDetails:k,id:q},V)=>(x(),A("div",{key:q,style:{display:"flex","flex-direction":"column"}},[j("div",at,[j("span",{style:Ve(k.value==="off"&&"font-style: italic;color: #a2a2a2")},le(`${r}-${b} - ${k.label}`),5),H(re,{rounded:"",flat:"",color:"grey",dense:"",size:"12px",icon:"delete",onClick:T=>_e(q)},null,8,["onClick"])]),V+1!==y.value.length?(x(),B(je,{key:0,style:{margin:"5px 0"}})):E("",!0)]))),128))])):E("",!0),i.value?(x(),A("div",nt,[(x(!0),A(te,null,ae(m.value,r=>(x(),B(Fe,{key:r,outline:v.value!==r,"onUpdate:selected":()=>me(r),clickable:"",color:"primary","text-color":"white"},{default:Q(()=>[ne(le(r),1)]),_:2},1032,["outline","onUpdate:selected"]))),128)),m.value.length?(x(),B(re,{key:0,disable:!v.value,class:"full-width",style:{"margin-top":"15px"},"no-caps":"",dense:"",color:"green",rounded:"",onClick:Se},{default:Q(()=>t[8]||(t[8]=[ne("Salveaza programarea ")])),_:1},8,["disable"])):(x(),A("span",lt,"Nu exista ora disponibila pentru data selectata !"))])):E("",!0)]}),_:1})]))}};export{dt as default};
